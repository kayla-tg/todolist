<h1 class="text-2xl mb-4">To-Do List</h1>

<%= form_with(model: Todo.new, local: true) do |form| %>
  <label>Description</label>
  <%= form.text_field :description, placeholder: "What needs to be done?" %>
  <%= form.submit "Add Todo" %>
<% end %>

<table>
  <tbody>
    <% @todos.each do |todo| %>
      <tr>
        <td>
          <%= form_with(url: todo_path(todo), method: :patch, local: true) do |f| %>
            <%= f.check_box :completed, checked: todo.completed, onchange: "this.form.submit()" %>
          <% end %>
        </td>

        <td>
          <%= form_with(model: todo, url: todo_path(todo), method: :patch, local: true, id: "form_#{todo.id}") do |f| %>
            <%= f.text_field :description,
                            id: "input_#{todo.id}",
                            value: todo.description,
                            class: "border rounded px-2 py-1 text-sm w-full",
                            disabled: true %>
            <button
              type="button"
              id="edit_button_<%= todo.id %>"
              onclick="toggleEdit(<%= todo.id %>)"
              class="text-blue-600 underline text-sm"
            >
              Edit
            </button>
          <% end %>
        </td>

        <td>
          <%= button_to "Delete", todo_path(todo), method: :delete %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
